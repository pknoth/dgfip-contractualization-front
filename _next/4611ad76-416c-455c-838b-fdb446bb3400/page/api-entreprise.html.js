module.exports=__NEXT_REGISTER_PAGE("/api-entreprise.html",function(){var e=webpackJsonp([10],{13:function(e,t,a){"use strict";var n=a(0);var r=a.n(n);var i=a(1);var o=a.n(i);var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}();function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"===typeof t||"function"===typeof t)?t:e}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){d(t,e);function t(e){s(this,t);var a=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));var n=a.props.pathName;a.state={pathName:n};return a}l(t,[{key:"componentDidMount",value:function e(){var t=this.state.pathName;localStorage.setItem("redirect",t||"")}},{key:"render",value:function e(){return r.a.createElement("div",{className:"redirect"})}}]);return t}(r.a.Component);u.defaultProps={pathName:"/"};t["a"]=u},270:function(e,t,a){e.exports=a(91)},91:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(0);var r=a.n(n);var i=a(1);var o=a.n(i);var l=a(9);var s=a(19);var c=a.n(s);var d=a(4);var u=a(21);var m=a(49);var f=a.n(m);var p=a(92);var h=a.n(p);var v=a(18);v.defaults.adapter=f.a;var b={getScopes:function e(){if(true)return v.get("https://sandbox.dashboard.entreprise.api.gouv.fr"+"/api/admin/roles").then(function(e){return e.data});return Promise.resolve(h.a)}};var _=b;var E=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}();function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"===typeof t||"function"===typeof t)?t:e}function N(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var C=a(18);var w=[{id:"dpo",heading:"Délégué à la protection des données",description:"https://www.cnil.fr/fr/designation-dpo"},{id:"responsable_traitement",heading:"Responsable de traitement"},{id:"metier",heading:"Responsable métier"},{id:"technique",heading:"Responsable technique"}];var P=function(e){N(t,e);function t(e){g(this,t);var a=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.state={scopes:[],errors:[],enrollment:{fournisseur_de_donnees:"api-entreprise",scopes:{},acl:{send_application:true},contacts:w,siren:"",demarche:{intitule:"",description:"",fondement_juridique:""},donnees:{conservation:"",destinataires:""},validation_de_convention:false,"validation_delegue_a_la_protection_des_données":false}};a.handleChange=a.handleChange.bind(a);a.handleSubmit=a.handleSubmit.bind(a);a.getSiren=a.getSiren.bind(a);a.handleSiren=a.handleSiren.bind(a);return a}E(t,[{key:"componentDidMount",value:function e(){var t=this;var a=this.props.id;_.getScopes().then(function(e){t.setState({scopes:e})});var n=void 0;if("undefined"!==typeof localStorage)n=localStorage.getItem("token");if(a){n=localStorage.getItem("token");d["a"].getUserEnrollment(a,n).then(function(e){t.setState({enrollment:e})})}}},{key:"handleChange",value:function e(t){var a=t.target;var n="checkbox"===a.type?a.checked:a.value;var r=a.name;var i=Object.assign({},this.state);u["a"].deepSetInState(r,n,i);this.setState(i)}},{key:"handlePeopleChange",value:function e(t){var a=this;return function(e){var n=a.state.enrollment;var r=e.target;var i=r.value;var o=r.name;n=Object.assign({},n);n.contacts=n.contacts.map(function(e){if(e.id===t.id){e[o]=i;return e}return e});a.setState({enrollment:n})}}},{key:"handleSubmit",value:function e(t){var a=this;var n=this.state;var r=localStorage.getItem("token");if(n.enrollment.id)d["a"].updateUserEnrollment(n,r).then(function(e){if(200===e.status)c.a.push("/")}).catch(function(e){if(422===e.response.status)return;var t=[];var n=void 0;for(n in e.response.data)if(Object.prototype.hasOwnProperty.call(e.response.data,n)){var r=e.response.data[n];t=t.concat(r)}a.setState({errors:t})});else d["a"].createUserEnrollment(n,r).then(function(e){if(201===e.status)c.a.push("/")}).catch(function(e){if(!(422===e.response.status))return;var t=[];var n=void 0;for(n in e.response.data)if(Object.prototype.hasOwnProperty.call(e.response.data,n))t=t.concat(e.response.data[n]);a.setState({errors:t})});t.preventDefault()}},{key:"handleSiren",value:function e(t){this.handleChange(t);this.getSiren()}},{key:"getSiren",value:function e(){var t=this;var a=this.state.enrollment;var n=a.siren.replace(/ /g,"");C.get("https://sirene.entreprise.api.gouv.fr/v1/siren/"+n).then(function(e){var n=e.data.siege_social[0];var r=n.nom_raison_sociale;var i=n.activite_principale;var o=[n.l2_normalisee,n.l3_normalisee,n.l4_normalisee,n.l5_normalisee,n.l6_normalisee,n.l7_normalisee].filter(function(e){return e}).join(", ");t.setState({sirenNotFound:false});t.setState({enrollment:Object.assign(a,{raison_sociale:r,adresse:o,code_naf:i})})}).catch(function(){return t.setState({sirenNotFound:true})})}},{key:"render",value:function e(){var t=this;var a=this.state,n=a.enrollment,i=a.sirenNotFound,o=a.errors,l=a.scopes;var s=n.acl.send_application?false:"disabled";var c=0;var d=function e(a){a.id=a.id||"person_"+c++;return r.a.createElement("div",{key:a.id,className:"card"},r.a.createElement("div",{className:"card__content"},r.a.createElement("h3",null,a.heading),a.description&&r.a.createElement("div",{className:"card__meta"},a.description),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"person_"+a.id+"_nom"},"Nom et Prénom"),r.a.createElement("input",{type:"text",onChange:t.handlePeopleChange(a),name:"nom",id:"person_"+a.id+"_nom",disabled:s,value:a.nom})),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"person_"+a.id+"_email"},"Email"),r.a.createElement("input",{type:"text",onChange:t.handlePeopleChange(a),name:"email",id:"person_"+a.id+"_email",disabled:s,value:a.email}))))};return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("h1",null,"Demande d'accès à API Entreprise"),r.a.createElement("p",null,"Pour avoir accès à l'API Entreprise, diffusant des données personnelles, vous devez obtenir un agrément.  L'accès à cette API n'est pour l'instant disponible que si vous êtes:"),r.a.createElement("ul",null,r.a.createElement("li",null,"une administration;"),r.a.createElement("li",null,"une entreprise prestataire d'une administration ou ayant une délégation de service public.")),r.a.createElement("p",null,"Pour utiliser API Entreprise, vous devez vous engager à traiter la bonne donnée par le bon agent de la collectivité et informer correctement l’usager, c'est à dire explicitement demander l'accord de l'usager pour récupérer ses données auprès d'un fournisseur."),r.a.createElement("h2",{id:"identite"},"Identité"),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"search-siren"},"Rechercher votre organisme avec son SIREN"),r.a.createElement("div",{className:"search__group"},r.a.createElement("input",{type:"text",value:n.siren,name:"enrollment.siren",id:"search-siren",onChange:this.handleSiren}),r.a.createElement("button",{className:"overlay-button",type:"button","aria-label":"Recherche",onClick:this.getSiren},r.a.createElement("svg",{className:"icon icon-search",id:"icon-search",width:"100%",height:"100%"},r.a.createElement("title",null,"Rechercher"),r.a.createElement("path",{d:"M15.504 13.616l-3.79-3.223c-0.392-0.353-0.811-0.514-1.149-0.499 0.895-1.048 1.435-2.407 1.435-3.893 0-3.314-2.686-6-6-6s-6 2.686-6 6 2.686 6 6 6c1.486 0 2.845-0.54 3.893-1.435-0.016 0.338 0.146 0.757 0.499 1.149l3.223 3.79c0.552 0.613 1.453 0.665 2.003 0.115s0.498-1.452-0.115-2.003zM6 10c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"}))))),i&&r.a.createElement("div",{className:"notification warning"},"Nos service ne parviennent pas à trouver votre SIREN"),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"raison_sociale"},"Raison sociale"),r.a.createElement("input",{type:"text",onChange:this.handleChange,name:"enrollment.raison_sociale",id:"raison_sociale",disabled:true,value:n.raison_sociale})),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"adresse"},"Adresse"),r.a.createElement("input",{type:"text",onChange:this.handleChange,name:"enrollment.adresse",id:"adresse",disabled:true,value:n.adresse})),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"code_naf"},"Code NAF"),r.a.createElement("input",{type:"text",onChange:this.handleChange,name:"enrollment.code_naf",id:"code_naf",disabled:true,value:n.code_naf})),r.a.createElement("h3",null,"Contacts"),r.a.createElement("div",{className:"row card-row"},n.contacts.map(function(e){return d(e)})),r.a.createElement("h2",{id:"demarche"},"Démarche"),r.a.createElement("section",{className:"information-text"},r.a.createElement("p",null,"C'est la raison pour laquelle vous collectez des données personnelles, l'objectif qui est poursuivi par le fichier que vous mettez en place. Par exemple, « télé-procédure permettant aux usagers de demander une aide au paiement de la cantine des collégiens » ou « télé-procédure de demande de bourses de lycée »."),r.a.createElement("p",null,"Il vous est également demandé de préciser les références du fondement légal de votre droit à demander ces informations (délibération du conseil municipal, décret …) ainsi que les informations relatives à votre téléservice.")),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"intitule_demarche"},"Intitulé"),r.a.createElement("input",{type:"text",onChange:this.handleChange,name:"enrollment.demarche.intitule",id:"intitule_demarche",disabled:s,value:n.demarche.intitule})),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"description_service"},"Décrivez brièvement votre service ainsi que l‘utilisation prévue des données transmises"),r.a.createElement("textarea",{rows:"10",onChange:this.handleChange,name:"enrollment.demarche.description",id:"description_service",disabled:s,value:n.demarche.description})),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"fondement_juridique"},"Cadre juridique ",r.a.createElement("i",null,"(Indiquez la référence ou l'URL du texte de loi)")),r.a.createElement("input",{type:"text",onChange:this.handleChange,name:"enrollment.demarche.fondement_juridique",id:"fondement_juridique_demarche",disabled:s,value:n.demarche.fondement_juridique})),r.a.createElement("h2",{id:"donnees"},"Données"),r.a.createElement("div",{className:"form__group"},r.a.createElement("fieldset",{className:"vertical"},r.a.createElement("label",null,"Sélectionnez vos jeux de données souhaités"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column",style:{flex:1}},l.map(function(e){var a=e.code;return r.a.createElement("div",{key:e.id},r.a.createElement("input",{className:"scope__checkbox",onChange:t.handleChange,type:"checkbox",name:"enrollment.scopes."+a,id:"checkbox-scope_api_entreprise"+a,disabled:s,checked:n.scopes[a]?"checked":false}),r.a.createElement("label",{htmlFor:"checkbox-scope_api_entreprise"+a,className:"label-inline"},e.name),r.a.createElement("div",{className:"scope__destinataire"},r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"destinataire_"+a},"Destinataires ",r.a.createElement("a",{href:"https://www.cnil.fr/fr/definition/destinataire",target:"_blank",rel:"noopener noreferrer"},"(plus d´infos)")),r.a.createElement("input",{type:"text",onChange:t.handleChange,name:"enrollment.donnees.destinataires."+a,id:"desinataire_"+a,disabled:s,value:n.donnees.destinataires[a]}))))}))))),r.a.createElement("div",{className:"form__group"},r.a.createElement("label",{htmlFor:"donnees_conservation"},"Conservation des données ",r.a.createElement("i",null,"(en mois)")),r.a.createElement("input",{type:"number",onChange:this.handleChange,name:"enrollment.donnees.conservation",id:"donnees_conservation",disabled:s,value:n.donnees.conservation})),r.a.createElement("h1",{id:"convention"},"Convention"),r.a.createElement("section",{className:"information-text"},r.a.createElement("p",null,"Votre raccordement à l'API « Impôt Particulier » nécessite l'acceptation de la convention d'adhésion fixant vos engagements et ceux de la DGFIP et la DINSIC. ",r.a.createElement("br",null)," Les liens ci-dessous vous permettront de visualiser la convention type ainsi que ses annexes. ",r.a.createElement("br",null)," La convention générée à l'issue de votre demande de raccordement contiendra l'ensemble des éléments propres à votre situation. ",r.a.createElement("br",null)," Cette convention sera publiée sur api.gouv.fr et sera accessible via vos identifiants FranceConnect.")),r.a.createElement("iframe",{src:"static/docs/charte-fc.pdf",width:"100%",height:"800px"}),r.a.createElement("div",{className:"form__group"},r.a.createElement("input",{onChange:this.handleChange,disabled:s,checked:n.validation_de_convention,type:"checkbox",name:"enrollment.validation_de_convention",id:"validation_de_convention"}),r.a.createElement("label",{htmlFor:"validation_de_convention",className:"label-inline"},"Je valide la présente convention et confirme que le DPO de mon organisme est informé de ma demande")),!s&&r.a.createElement("div",{className:"button-list"},n.id&&r.a.createElement("button",{className:"button",type:"submit",name:"subscribe",id:"submit"},"Modifier la demande"),!n.id&&r.a.createElement("button",{className:"button",type:"submit",name:"subscribe",id:"submit"},"Soumettre la demande")),o.map(function(e){var t=0;return r.a.createElement("div",{key:t++,className:"notification error"},e)}))}}]);return t}(r.a.Component);P.defaultProps={id:""};var S=P;var O=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}();function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"===typeof t||"function"===typeof t)?t:e}function k(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var I=function(e){k(t,e);function t(){x(this,t);return j(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}O(t,[{key:"render",value:function e(){return r.a.createElement("nav",{className:"side-pane"},r.a.createElement("ul",{className:"side-pane__menu"},r.a.createElement("li",{className:"side-pane__title"},r.a.createElement("h3",null,"Votre demande")),r.a.createElement("li",null,r.a.createElement("a",{className:"side-pane__link",href:"#identite"},"Identité")),r.a.createElement("li",null,r.a.createElement("a",{className:"side-pane__link",href:"#demarche"},"Démarche")),r.a.createElement("li",null,r.a.createElement("a",{className:"side-pane__link",href:"#donnees"},"Données"))))}}]);return t}(r.a.Component);var F=I;var q=a(13);var R=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}();function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"===typeof t||"function"===typeof t)?t:e}function T(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var z=function(e){T(t,e);function t(){D(this,t);return A(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}R(t,[{key:"render",value:function e(){var t=this.props.url;return r.a.createElement("div",null,r.a.createElement(q["a"],{pathName:t.asPath}),r.a.createElement(l["a"],{requireUser:true},r.a.createElement("div",{className:"documentation"},r.a.createElement(F,null),r.a.createElement("div",{className:"main-pane"},r.a.createElement(S,{id:t.query.id})))))}}]);return t}(r.a.Component);z.defaultProps={url:""};var M=t["default"]=z},92:function(e,t){e.exports=[{id:"b34d951f-559e-4374-832e-ecd210467de1",name:"Attestation AGEFIPH",code:"attestations_agefiph"},{id:"cdbc5d85-c42e-4714-85a9-b7722a3943dc",name:"Attestation Fiscale",code:"attestations_fiscales"},{id:"17ea7121-cc76-42f0-bef3-1512da6f0ecd",name:"Attestation Sociale",code:"attestations_sociales"},{id:"1fccafbd-bff1-4ad5-a4de-535e1b4c25f5",name:"Certificat CNETP",code:"certificat_cnetp"},{id:"79916597-e719-400a-a4e4-0160267fde42",name:"Association",code:"associations"},{id:"45c956f1-8ba7-4d30-a0a0-d748c623ab8d",name:"Certificat OPQIBI",code:"certificat_opqibi"},{id:"ccd4c3bf-6ea5-45a3-9c6b-76314dfd169a",name:"Document association",code:"documents_association"},{id:"ea918360-055b-4877-ad72-5494fc3478ea",name:"INSEE Etablissement",code:"etablissements"},{id:"35cf0844-48f1-4a51-85e1-5c48aaa98463",name:"INSEE Entreprise",code:"entreprises"},{id:"994c533f-e4d3-4b31-95f1-fc258078020a",name:"Extrait INPI",code:"extrait_court_inpi"},{id:"f7181804-ed1e-4ce9-a5a6-683449b6f777",name:"Extrait RCS",code:"extraits_rcs"},{id:"e2832c88-2a8f-43e8-8b70-60eaa48741fa",name:"Exercice",code:"exercices"},{id:"f4410413-7f95-4cc3-a61c-075e18cbccdd",name:"Liasse fiscale",code:"liasse_fiscale"},{id:"fb2fd633-679a-4e94-b192-9c6f96093354",name:"Carte Pro FNTP",code:"fntp_carte_pro"},{id:"9d2b052a-bd0f-4d99-a0df-fa2fa5550666",name:"Certificat Qualibat",code:"qualibat"},{id:"9a1fb7c8-399d-4332-b87b-5376da4eaba8",name:"Certificat PROBTP",code:"probtp"},{id:"c1c6594e-f19f-40ae-912e-d63439a2b0b3",name:"Cotisation MSA",code:"msa_cotisations"}]}},[270]);return{page:e.default}});